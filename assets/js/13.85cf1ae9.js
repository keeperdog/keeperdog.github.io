(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{331:function(t,s,a){t.exports=a.p+"assets/img/2025-07-09-08-49-30.19ee1c6b.png"},332:function(t,s,a){t.exports=a.p+"assets/img/2025-07-09-08-52-42.de3e6352.png"},333:function(t,s,a){t.exports=a.p+"assets/img/2025-07-09-12-25-04.93eba88d.png"},334:function(t,s,a){t.exports=a.p+"assets/img/2025-07-09-21-26-21.4a33cfef.png"},335:function(t,s,a){t.exports=a.p+"assets/img/2025-07-09-23-07-28.23823644.png"},336:function(t,s,a){t.exports=a.p+"assets/img/2025-07-09-23-03-28.d87ef7b2.png"},337:function(t,s,a){t.exports=a.p+"assets/img/2025-07-09-21-59-33.b762efe7.png"},338:function(t,s,a){t.exports=a.p+"assets/img/2025-07-09-22-12-46.67acff32.png"},339:function(t,s,a){t.exports=a.p+"assets/img/2025-07-09-22-17-20.4c700044.png"},340:function(t,s,a){t.exports=a.p+"assets/img/2025-07-10-10-14-54.e80006cd.png"},372:function(t,s,a){"use strict";a.r(s);var n=a(18),e=Object(n.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"llm-ai-相关例子-demo"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#llm-ai-相关例子-demo"}},[t._v("#")]),t._v(" LLM AI 相关例子 demo")]),t._v(" "),s("p",[t._v("每一个例子都有自己的去练习过")]),t._v(" "),s("h2",{attrs:{id:"提示词工程"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#提示词工程"}},[t._v("#")]),t._v(" 提示词工程")]),t._v(" "),s("p",[t._v("这是一个基于 Gradio 的 Web 应用，结合 智谱 AI GLM-4 模型，提供多个社交场景的 AI 对话服务。用户可选择不同场景（如“敬酒”、“送礼”等），获取系统提示词、示例对话，并与 AI 实时互动。")]),t._v(" "),s("p",[t._v("传送门："),s("a",{attrs:{href:"https://www.modelscope.cn/studios/deshengkong/prompt_engineering_demo_001",target:"_blank",rel:"noopener noreferrer"}},[t._v("prompt_engineering_demo"),s("OutboundLink")],1),t._v(" "),s("img",{attrs:{src:a(331),alt:"snapshot"}})]),t._v(" "),s("h2",{attrs:{id:"ai-聊天机器人"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ai-聊天机器人"}},[t._v("#")]),t._v(" AI 聊天机器人")]),t._v(" "),s("p",[t._v("这个 demo 实现了一个基于 "),s("strong",[t._v("Streamlit")]),t._v(" 框架的 AI 聊天机器人应用")]),t._v(" "),s("p",[t._v("传送门："),s("a",{attrs:{href:"https://www.modelscope.cn/studios/deshengkong/chatbox_demo_001",target:"_blank",rel:"noopener noreferrer"}},[t._v("chatbox_demo"),s("OutboundLink")],1),t._v(" "),s("img",{attrs:{src:a(332),alt:"snapshot"}})]),t._v(" "),s("ul",[s("li",[t._v("初始化并维护聊天记录 ("),s("code",[t._v("messages")]),t._v(")，包括用户和助手的消息。")]),t._v(" "),s("li",[t._v("当用户提交问题时，将用户输入添加到会话历史，并显示在聊天界面上。")]),t._v(" "),s("li",[t._v("使用 "),s("code",[t._v("OpenAI")]),t._v(" 客户端调用远程模型（如 Qwen2.5-7B-Instruct）进行流式响应生成。")]),t._v(" "),s("li",[t._v("将系统提示（system message）、用户输入（user query）发送给模型，并逐步接收和展示 AI 的回复。")]),t._v(" "),s("li",[t._v("使用 "),s("code",[t._v("Streamlit")]),t._v(" 构建简洁的网页界面，支持 Markdown 和 HTML 渲染，展示 AI 的思考过程和最终回答。")])]),t._v(" "),s("h2",{attrs:{id:"rag-langchain-版本"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#rag-langchain-版本"}},[t._v("#")]),t._v(" RAG-Langchain 版本")]),t._v(" "),s("p",[t._v("这个 demo 是实现一个基于"),s("strong",[t._v("Gradio")]),t._v("的 RAG 模型，基于 langchain 实现。")]),t._v(" "),s("ul",[s("li",[t._v("选择Embedding模型（HuggingFace或ZhipuAI）")]),t._v(" "),s("li",[t._v("设置文本块大小（建议800-1000）")]),t._v(" "),s("li",[t._v("配置数据源（本地文件夹或网页URL）")]),t._v(" "),s("li",[t._v("点击”初始化数据库”开始对话")])]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 基本组件")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" langchain_community"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("document_loaders "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" DirectoryLoader\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" langchain_text_splitters "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" RecursiveCharacterTextSplitter\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" langchain_chroma "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" Chroma\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 核心流程")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.")]),t._v(" 加载文档\nloader "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" DirectoryLoader"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("data_path"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" glob"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"*.txt"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2.")]),t._v(" 文本分割\ntext_splitter "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" RecursiveCharacterTextSplitter"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    chunk_size"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("chunk_size"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    chunk_overlap"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("200")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3.")]),t._v(" 创建向量数据库\nvectordb "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Chroma"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("from_documents"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    documents"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("split_docs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    embedding"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("embedding_func"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    persist_directory"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("persist_directory"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("python run/demo_rag_langchain_onlinellm.py\n")])])]),s("p",[s("img",{attrs:{src:a(333),alt:"snapshot"}})]),t._v(" "),s("h2",{attrs:{id:"rag-langchain-个人知识库助手"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#rag-langchain-个人知识库助手"}},[t._v("#")]),t._v(" RAG-LangChain 个人知识库助手")]),t._v(" "),s("p",[t._v("TODO")]),t._v(" "),s("h2",{attrs:{id:"rag-llamaindex-简单版本"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#rag-llamaindex-简单版本"}},[t._v("#")]),t._v(" RAG-LlamaIndex 简单版本")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 基本组件")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" llama_index"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("core "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" SimpleDirectoryReader"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" VectorStoreIndex\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" llama_index"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("vector_stores"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("faiss "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" FaissVectorStore\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 核心流程")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.")]),t._v(" 加载文档\ndocuments "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" SimpleDirectoryReader"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("data_dir"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("load_data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2.")]),t._v(" 创建索引\nindex "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" VectorStoreIndex"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("from_documents"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    documents"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    storage_context"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("storage_context\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3.")]),t._v(" 创建检索器\nretriever "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" VectorIndexRetriever"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("index"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("index"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("python test/knowledges/llamaindex/test_RAG_zhipuai_simple.py\n")])])]),s("p",[s("img",{attrs:{src:a(334),alt:"snapshot"}})]),t._v(" "),s("h2",{attrs:{id:"rag-llamaindex-高级版本"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#rag-llamaindex-高级版本"}},[t._v("#")]),t._v(" RAG-LlamaIndex 高级版本")]),t._v(" "),s("p",[t._v("TODO")]),t._v(" "),s("h2",{attrs:{id:"tavily-web-search"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#tavily-web-search"}},[t._v("#")]),t._v(" Tavily - Web Search")]),t._v(" "),s("p",[s("strong",[t._v("职责：")]),t._v(" 测试tavily的web搜索功能")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[t._v("tavily_client "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" TavilyClient"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("api_key"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("os"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("getenv"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"TAVILY_API_KEY"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nresponse "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" tavily_client"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("search"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"What is the weather in Shanghai?"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("max_results"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" url "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" response"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'results'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("url"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'url'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[s("strong",[t._v("Rund Demo")])]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("python test/agents/metagpt/test_WebSearch.py    \n")])])]),s("p",[s("img",{attrs:{src:a(335),alt:"snapshot"}})]),t._v(" "),s("h2",{attrs:{id:"metagpt-智能体之简单加减"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#metagpt-智能体之简单加减"}},[t._v("#")]),t._v(" Metagpt - 智能体之简单加减")]),t._v(" "),s("p",[s("strong",[t._v("职责：")]),t._v(" 一个超级简单的加减功能")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("SimpleCalculator")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Action"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token triple-quoted-string string"}},[t._v('"""一个简单的计算Action"""')]),t._v("\n    name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("str")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"SimpleCalculator"')]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("run")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("self"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" instruction"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("str")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("str")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("try")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 解析输入")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string-interpolation"}},[s("span",{pre:!0,attrs:{class:"token string"}},[t._v('f"当前run ： ')]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("type")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("instruction"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("instruction"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n            num1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" num2 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("map")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("int")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" instruction"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("split"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'+'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n            result "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string-interpolation"}},[s("span",{pre:!0,attrs:{class:"token string"}},[t._v('f"')]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("num1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v(" + ")]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("num2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v(" = ")]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("num1 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" num2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"')])]),t._v("\n            logger"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("info"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string-interpolation"}},[s("span",{pre:!0,attrs:{class:"token string"}},[t._v('f"计算结果: ')]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("result"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" result\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("except")]),t._v(" Exception "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" e"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n            error_msg "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string-interpolation"}},[s("span",{pre:!0,attrs:{class:"token string"}},[t._v('f"计算错误: ')]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("str")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("e"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"')])]),t._v("\n            logger"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("error"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("error_msg"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" error_msg\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CalculatorAssistant")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Role"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token triple-quoted-string string"}},[t._v('"""计算助手角色\n\n    ReAct 循环的模式，目前支持 REACT、BY_ORDER、PLAN_AND_ACT 3种模式，\n    默认使用 REACT 模式。在 _set_react_mode 方法中有相关说明。简单来说，BY_ORDER 模式按照指定的 Action 顺序执行。\n    PLAN_AND_ACT 则为一次思考后执行多个动作，即 _think -> _act -> act -> ...，\n    而 REACT 模式按照 ReAct 论文中的思考——行动循环来执行，即 _think -> _act -> _think -> _act -> ...。\n    """')]),t._v("\n    name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("str")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Calculator"')]),t._v("\n    profile"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("str")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"一个简单的计算助手，负责计算两个数字的和"')]),t._v("\n    \n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("__init__")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("self"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("**")]),t._v("kwargs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("super")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("__init__"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("**")]),t._v("kwargs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        self"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("set_actions"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("SimpleCalculator"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        self"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("_set_react_mode"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("react_mode"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("RoleReactMode"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("BY_ORDER"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("value"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("_act")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("self"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" Message"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        logger"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("info"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string-interpolation"}},[s("span",{pre:!0,attrs:{class:"token string"}},[t._v('f"')]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("self"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("_setting"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v(": to do ")]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("self"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("rc"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("todo"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("self"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("rc"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("todo"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v(')"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        todo "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" self"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("rc"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("todo\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string-interpolation"}},[s("span",{pre:!0,attrs:{class:"token string"}},[t._v('f"当前_act ： ')]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("type")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("self"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("rc"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("todo"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("self"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("rc"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("todo"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n        msg "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" self"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("get_memories"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("k"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 获取最近的消息")]),t._v("\n        result "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" todo"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("run"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("msg"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("content"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        \n        msg "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Message"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("content"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("result"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" role"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("self"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("profile"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" cause_by"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("type")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("todo"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" msg\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("run_example")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("msg"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("str")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token triple-quoted-string string"}},[t._v('"""运行单个计算示例"""')]),t._v("\n    role "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" CalculatorAssistant"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    logger"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("info"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string-interpolation"}},[s("span",{pre:!0,attrs:{class:"token string"}},[t._v('f"输入: ')]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("msg"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    result "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" asyncio"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("run"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("role"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("run"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("msg"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    logger"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("info"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string-interpolation"}},[s("span",{pre:!0,attrs:{class:"token string"}},[t._v('f"结果: ')]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("result"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"-"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("50")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("main")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token triple-quoted-string string"}},[t._v('"""运行多个计算示例"""')]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 基本加法示例")]),t._v("\n    run_example"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"5 + 3"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 大数加法示例")]),t._v("\n    run_example"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1234 + 5678"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 负数加法示例")]),t._v("\n    run_example"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"-10 + 5"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 错误输入示例")]),t._v("\n    run_example"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"abc + def"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 零的加法示例")]),t._v("\n    run_example"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"0 + 100"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" __name__ "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"__main__"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    fire"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Fire"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("main"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[s("strong",[t._v("Rund Demo")])]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("python test/agents/metagpt/test_metagpt_dummy.py \n")])])]),s("p",[s("img",{attrs:{src:a(336),alt:"snapshot"}})]),t._v(" "),s("h2",{attrs:{id:"metagpt-智能体之意图识别"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#metagpt-智能体之意图识别"}},[t._v("#")]),t._v(" Metagpt - 智能体之意图识别")]),t._v(" "),s("p",[s("strong",[t._v("职责")]),t._v("：分析用户输入，识别用户意图并映射到预定义场景")]),t._v(" "),s("p",[s("strong",[t._v("主要功能")]),t._v("：")]),t._v(" "),s("ul",[s("li",[t._v("分析用户输入的自然语言文本")]),t._v(" "),s("li",[t._v("识别用户当前的意图和需求")]),t._v(" "),s("li",[t._v("将用户问题匹配到预定义的场景类型")]),t._v(" "),s("li",[t._v("输出场景标签供后续处理")])]),t._v(" "),s("p",[s("strong",[t._v("可用Actions")]),t._v("：")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[t._v("  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("IntentAnalyze")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Action"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token triple-quoted-string string"}},[t._v('"""分析用户意图并映射到预定义场景标签\n      使用LLM分析用户输入，返回对应的场景类型编号\n      """')]),t._v("\n      name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("str")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"IntentAnalyze"')]),t._v("\n")])])]),s("p",[s("strong",[t._v("Run demo:")])]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("streamlit run test/agents/metagpt_agents/intentRecognition/role.py\n")])])]),s("p",[s("img",{attrs:{src:a(337),alt:"snapshot"}})]),t._v(" "),s("h2",{attrs:{id:"metagpt-智能体之场景细化"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#metagpt-智能体之场景细化"}},[t._v("#")]),t._v(" Metagpt - 智能体之场景细化")]),t._v(" "),s("p",[s("strong",[t._v("职责")]),t._v("：提取和完善场景要素")]),t._v(" "),s("p",[s("strong",[t._v("主要功能")]),t._v("：")]),t._v(" "),s("ul",[s("li",[t._v("信息抽取：从用户对话中提取场景要素")]),t._v(" "),s("li",[t._v("提问助手：对缺失的场景要素进行提问")]),t._v(" "),s("li",[t._v("场景要素验证：确保所有必要信息完整")])]),t._v(" "),s("p",[s("strong",[t._v("可用Actions")]),t._v("：")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("sceneRefineAnalyze")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Action"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token triple-quoted-string string"}},[t._v('"""提取场景要素\n      从用户输入中提取特定场景所需的关键信息\n      """')]),t._v("\n      name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("str")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"sceneRefineAnalyze"')]),t._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RaiseQuestion")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Action"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token triple-quoted-string string"}},[t._v('"""生成补充问题\n      针对缺失的场景要素生成自然的追问\n      """')]),t._v("\n      name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("str")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"RaiseQuestion"')]),t._v("\n")])])]),s("p",[s("strong",[t._v("Run demo:")])]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v(" streamlit run test/agents/metagpt/sceneRefine_test_case.py \n")])])]),s("p",[s("img",{attrs:{src:a(338),alt:"snapshot"}})]),t._v(" "),s("h2",{attrs:{id:"metagpt-智能体之回答助手"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#metagpt-智能体之回答助手"}},[t._v("#")]),t._v(" Metagpt - 智能体之回答助手")]),t._v(" "),s("p",[s("strong",[t._v("职责")]),t._v("：基于场景要素生成定制化回答")]),t._v(" "),s("p",[s("strong",[t._v("主要功能")]),t._v("：")]),t._v(" "),s("ul",[s("li",[t._v("整合场景信息和用户需求")]),t._v(" "),s("li",[t._v("生成针对性的建议和解答")]),t._v(" "),s("li",[t._v("提供详细的示例和说明")])]),t._v(" "),s("p",[s("strong",[t._v("可用Actions")]),t._v("：")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("AnswerQuestion")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Action"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token triple-quoted-string string"}},[t._v('"""生成定制化回答\n    基于完整的场景要素，生成符合用户需求的详细回答\n    使用模板系统确保回答的结构性和完整性\n    """')]),t._v("\n    name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("str")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"AnswerQuestion"')]),t._v("\n")])])]),s("p",[s("strong",[t._v("Run demo:")])]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v(" streamlit run test/agents/metagpt/answerBot_test_case.py \n")])])]),s("p",[s("img",{attrs:{src:a(339),alt:"snapshot"}})]),t._v(" "),s("h2",{attrs:{id:"metagpt-智能体之搜索助手"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#metagpt-智能体之搜索助手"}},[t._v("#")]),t._v(" Metagpt - 智能体之搜索助手")]),t._v(" "),s("p",[s("strong",[t._v("职责")]),t._v("：通过网络搜索补充回答内容")]),t._v(" "),s("p",[s("strong",[t._v("主要功能")]),t._v("：")]),t._v(" "),s("ul",[s("li",[t._v("查询扩展：生成相关搜索查询")]),t._v(" "),s("li",[t._v("网络搜索：使用搜索引擎获取相关信息")]),t._v(" "),s("li",[t._v("结果筛选：判断和筛选有价值的网页内容")]),t._v(" "),s("li",[t._v("内容提取：抓取和过滤网页内容")]),t._v(" "),s("li",[t._v("结果整合：将搜索结果整合到回答中")])]),t._v(" "),s("p",[s("strong",[t._v("可用Actions")]),t._v("：")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("QueryExpansion")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Action"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token triple-quoted-string string"}},[t._v('"""生成扩展查询\n    基于用户输入生成多个相关的搜索查询\n    """')]),t._v("\n    name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("str")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"queryExpansion"')]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("WebSearch")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Action"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token triple-quoted-string string"}},[t._v('"""执行网络搜索\n    使用搜索引擎获取相关网页内容\n    """')]),t._v("\n    name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("str")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"WebSearch"')]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("SelectResult")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Action"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token triple-quoted-string string"}},[t._v('"""筛选搜索结果\n    判断哪些搜索结果值得进一步分析\n    """')]),t._v("\n    name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("str")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"selectResult"')]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("SelectFetcher")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Action"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token triple-quoted-string string"}},[t._v('"""抓取网页内容\n    获取筛选后的网页的具体内容\n    """')]),t._v("\n    name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("str")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"selectFetcher"')]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("FilterSelectedResult")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Action"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token triple-quoted-string string"}},[t._v('"""过滤和提取信息\n    从网页内容中提取有价值的信息\n    """')]),t._v("\n    name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("str")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"FilterSelectedResult"')]),t._v("\n")])])]),s("p",[s("strong",[t._v("Run demo:")])]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v(" streamlit run test/agents/metagpt/searcher_test_case.py \n")])])]),s("video",{attrs:{src:"/Screen Recording 2025-07-09 at 22.32.04.mov",controls:"",width:"100%"}},[t._v("\n  您的浏览器不支持视频播放。\n")]),t._v(" "),s("h2",{attrs:{id:"xtuner-finetuning模型"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#xtuner-finetuning模型"}},[t._v("#")]),t._v(" XTuner FineTuning模型")]),t._v(" "),s("p",[s("strong",[t._v("XTuner")]),t._v(" 是一个基于 LLM 的模型微调工具，它可以帮助用户快速、轻松地微调 LLM 模型，从而提高模型的性能和效果。Xtuner 集成了 LoRA 和 QLoRA 等微调方法，让用户可以根据自身资源情况灵活选择；而 QLoRA 是 LoRA 在量化场景下的优化扩展。")]),t._v(" "),s("p",[s("strong",[t._v("平台")]),t._v("：Ubuntu + Anaconda + CUDA/CUDNN + 8GB nvidia显卡")]),t._v(" "),s("p",[s("strong",[t._v("安装")]),t._v("：")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 在 InternStudio 平台，则从本地 clone 一个已有 pytorch 2.0.1 的环境：")]),t._v("\n/root/share/install_conda_env_internlm_base.sh xtuner0.1.9\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 进入homoe 目录")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" ~\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 创建版本文件夹并进入，以跟随本教程")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("mkdir")]),t._v(" xtuner019 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" xtuner019\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 拉取 0.1.9 的版本源码")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" clone "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-b")]),t._v(" v0.1.9  https://github.com/InternLM/xtuner\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 无法访问github的用户请从 gitee 拉取:")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# git clone -b v0.1.9 https://gitee.com/Internlm/xtuner")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 进入源码目录")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" xtuner\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 从源码安装 XTuner")]),t._v("\npip "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-e")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'.[all]'")]),t._v("\n")])])]),s("p",[t._v("安装完后，就开始搞搞准备工作了。（准备在 oasst1 数据集上微调 internlm-7b-chat）")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 创建一个微调 oasst1 数据集的工作路径，进入")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("mkdir")]),t._v(" ~/ft-oasst1 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" ~/ft-oasst1\n")])])]),s("p",[s("strong",[t._v("微调：")]),t._v("\nXTuner 提供多个开箱即用的配置文件，用户可以通过下列命令查看：")]),t._v(" "),s("div",{staticClass:"language-Bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 列出所有内置配置")]),t._v("\nxtuner list-cfg\n")])])]),s("blockquote",[s("p",[t._v("假如显示bash: xtuner: command not found的话可以考虑在终端输入 export PATH=$PATH:'/root/.local/bin'")])]),t._v(" "),s("p",[s("img",{attrs:{src:a(340),alt:"snapshot"}})]),t._v(" "),s("p",[t._v("拷贝一个配置文件到当前目录：\n"),s("code",[t._v("# xtuner copy-cfg ${CONFIG_NAME} ${SAVE_PATH}")])]),t._v(" "),s("p",[t._v("在本案例中即：（注意最后有个英文句号，代表复制到当前路径）")]),t._v(" "),s("div",{staticClass:"language-Bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" ~/ft-oasst1\nxtuner copy-cfg internlm_chat_7b_qlora_oasst1_e3 "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(".")]),t._v("\n")])])]),s("p",[t._v("配置文件名的解释：")]),t._v(" "),s("blockquote",[s("p",[t._v("xtuner copy-cfg internlm_chat_7b_qlora_oasst1_e3 .")])]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("模型名")]),t._v(" "),s("th",[t._v("internlm_chat_7b")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("使用算法")]),t._v(" "),s("td",[t._v("qlora")])]),t._v(" "),s("tr",[s("td",[t._v("数据集")]),t._v(" "),s("td",[t._v("oasst1")])]),t._v(" "),s("tr",[s("td",[t._v("把数据集跑几次")]),t._v(" "),s("td",[t._v("跑3次：e3 (epoch 3 )")])])])]),t._v(" "),s("p",[t._v("*无 chat比如 "),s("code",[t._v("internlm-7b")]),t._v(" 代表是基座(base)模型")]),t._v(" "),s("p",[s("strong",[t._v("模型下载：")])]),t._v(" "),s("blockquote",[s("p",[t._v("由于下载模型很慢，用教学平台的同学可以直接复制模型。")])]),t._v(" "),s("div",{staticClass:"language-Bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("ln")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-s")]),t._v(" /share/temp/model_repos/internlm-chat-7b ~/ft-oasst1/\n")])])]),s("p",[t._v("以上是通过软链的方式，将模型文件挂载到家目录下，优势是：")]),t._v(" "),s("ol",[s("li",[t._v("节省拷贝时间，无需等待")]),t._v(" "),s("li",[t._v("节省用户开发机存储空间")])]),t._v(" "),s("blockquote",[s("p",[t._v("当然，也可以用 "),s("code",[t._v("cp -r /share/temp/model_repos/internlm-chat-7b ~/ft-oasst1/")]),t._v(" 进行数据拷贝。")])]),t._v(" "),s("blockquote",[s("p",[t._v("以下是自己下载模型的步骤。")])]),t._v(" "),s("p",[t._v("不用 xtuner 默认的"),s("code",[t._v("从 huggingface 拉取模型")]),t._v("，而是提前从 "),s("s",[t._v("OpenXLab")]),t._v(" ModelScope 下载模型到本地")]),t._v(" "),s("div",{staticClass:"language-Bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 创建一个目录，放模型文件，防止散落一地")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("mkdir")]),t._v(" ~/ft-oasst1/internlm-chat-7b\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 装一下拉取模型文件要用的库")]),t._v("\npip "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" modelscope\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 从 modelscope 下载下载模型文件")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" ~/ft-oasst1\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("apt")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" git-lfs "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-y")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" lfs "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" lfs clone https://modelscope.cn/Shanghai_AI_Laboratory/internlm-chat-7b.git "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-b")]),t._v(" v1.0.3\n")])])]),s("p",[s("strong",[t._v("数据集下载：")])]),t._v(" "),s("blockquote",[s("p",[t._v("https://huggingface.co/datasets/timdettmers/openassistant-guanaco/tree/main")])]),t._v(" "),s("p",[t._v("由于 huggingface 网络问题，咱们已经给大家提前下载好了，复制到正确位置即可：")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" ~/ft-oasst1\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ...-guanaco 后面有个空格和英文句号啊")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("cp")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-r")]),t._v(" /root/share/temp/datasets/openassistant-guanaco "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(".")]),t._v("\n")])])]),s("p",[t._v("此时，当前路径的文件应该长这样：")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("-- internlm-chat-7b\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("   "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("-- README.md\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("   "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("-- config.json\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("   "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("-- configuration.json\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("   "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("-- configuration_internlm.py\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("   "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("-- generation_config.json\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("   "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("-- modeling_internlm.py\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("   "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("-- pytorch_model-00001-of-00008.bin\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("   "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("-- pytorch_model-00002-of-00008.bin\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("   "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("-- pytorch_model-00003-of-00008.bin\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("   "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("-- pytorch_model-00004-of-00008.bin\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("   "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("-- pytorch_model-00005-of-00008.bin\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("   "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("-- pytorch_model-00006-of-00008.bin\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("   "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("-- pytorch_model-00007-of-00008.bin\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("   "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("-- pytorch_model-00008-of-00008.bin\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("   "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("-- pytorch_model.bin.index.json\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("   "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("-- special_tokens_map.json\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("   "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("-- tokenization_internlm.py\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("   "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("-- tokenizer.model\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("   "),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("`")]),t._v("-- tokenizer_config.json\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("-- internlm_chat_7b_qlora_oasst1_e3_copy.py\n"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("`")])]),t._v("-- openassistant-guanaco\n    "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("-- openassistant_best_replies_eval.jsonl\n    `-- openassistant_best_replies_train.jsonl\n")])])]),s("p",[s("strong",[t._v("修改配置文件：")])]),t._v(" "),s("p",[t._v("修改其中的模型和数据集为 本地路径")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" ~/ft-oasst1\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("vim")]),t._v(" internlm_chat_7b_qlora_oasst1_e3_copy.py\n")])])]),s("blockquote",[s("p",[t._v("在vim界面完成修改后，请输入:wq退出。假如认为改错了可以用:q!退出且不保存。当然我们也可以考虑打开python文件直接修改，但注意修改完后需要按下Ctrl+S进行保存。")])]),t._v(" "),s("p",[t._v("减号代表要删除的行，加号代表要增加的行。")]),t._v(" "),s("div",{staticClass:"language-diff extra-class"},[s("pre",{pre:!0,attrs:{class:"language-diff"}},[s("code",[t._v("# 修改模型为本地路径\n"),s("span",{pre:!0,attrs:{class:"token deleted-sign deleted"}},[s("span",{pre:!0,attrs:{class:"token prefix deleted"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token line"}},[t._v(" pretrained_model_name_or_path = 'internlm/internlm-chat-7b'\n")])]),s("span",{pre:!0,attrs:{class:"token inserted-sign inserted"}},[s("span",{pre:!0,attrs:{class:"token prefix inserted"}},[t._v("+")]),s("span",{pre:!0,attrs:{class:"token line"}},[t._v(" pretrained_model_name_or_path = './internlm-chat-7b'\n")])]),t._v("\n# 修改训练数据集为本地路径\n"),s("span",{pre:!0,attrs:{class:"token deleted-sign deleted"}},[s("span",{pre:!0,attrs:{class:"token prefix deleted"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token line"}},[t._v(" data_path = 'timdettmers/openassistant-guanaco'\n")])]),s("span",{pre:!0,attrs:{class:"token inserted-sign inserted"}},[s("span",{pre:!0,attrs:{class:"token prefix inserted"}},[t._v("+")]),s("span",{pre:!0,attrs:{class:"token line"}},[t._v(" data_path = './openassistant-guanaco'\n")])])])])]),s("p",[s("strong",[t._v("常用超参")])]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("参数名")]),t._v(" "),s("th",[t._v("解释")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[s("strong",[t._v("data_path")])]),t._v(" "),s("td",[t._v("数据路径或 HuggingFace 仓库名")])]),t._v(" "),s("tr",[s("td",[t._v("max_length")]),t._v(" "),s("td",[t._v("单条数据最大 Token 数，超过则截断")])]),t._v(" "),s("tr",[s("td",[t._v("pack_to_max_length")]),t._v(" "),s("td",[t._v("是否将多条短数据拼接到 max_length，提高 GPU 利用率")])]),t._v(" "),s("tr",[s("td",[t._v("accumulative_counts")]),t._v(" "),s("td",[t._v("梯度累积，每多少次 backward 更新一次参数")])]),t._v(" "),s("tr",[s("td",[t._v("evaluation_inputs")]),t._v(" "),s("td",[t._v("训练过程中，会根据给定的问题进行推理，便于观测训练状态")])]),t._v(" "),s("tr",[s("td",[t._v("evaluation_freq")]),t._v(" "),s("td",[t._v("Evaluation 的评测间隔 iter 数")])]),t._v(" "),s("tr",[s("td",[t._v("......")]),t._v(" "),s("td",[t._v("......")])])])]),t._v(" "),s("blockquote",[s("p",[t._v("如果想把显卡的现存吃满，充分利用显卡资源，可以将 "),s("code",[t._v("max_length")]),t._v(" 和 "),s("code",[t._v("batch_size")]),t._v(" 这两个参数调大。")])]),t._v(" "),s("p",[t._v("开始微调")]),t._v(" "),s("p",[s("strong",[t._v("训练：")])]),t._v(" "),s("p",[t._v("xtuner train ${CONFIG_NAME_OR_PATH}")]),t._v(" "),s("p",[s("strong",[t._v("也可以增加 deepspeed 进行训练加速：")])]),t._v(" "),s("p",[t._v("xtuner train ${CONFIG_NAME_OR_PATH} --deepspeed deepspeed_zero2")]),t._v(" "),s("p",[t._v("例如，我们可以利用 QLoRA 算法在 oasst1 数据集上微调 InternLM-7B：")]),t._v(" "),s("div",{staticClass:"language-Bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 单卡")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## 用刚才改好的config文件训练")]),t._v("\nxtuner train ./internlm_chat_7b_qlora_oasst1_e3_copy.py\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 多卡")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("NPROC_PER_NODE")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${GPU_NUM}")]),t._v(" xtuner train ./internlm_chat_7b_qlora_oasst1_e3_copy.py\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 若要开启 deepspeed 加速，增加 --deepspeed deepspeed_zero2 即可")]),t._v("\n")])])]),s("blockquote",[s("p",[t._v("微调得到的 PTH 模型文件和其他杂七杂八的文件都默认在当前的 "),s("code",[t._v("./work_dirs")]),t._v(" 中。")])]),t._v(" "),s("p",[t._v("跑完训练后，当前路径应该长这样：")]),t._v(" "),s("div",{staticClass:"language-Bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("-- internlm-chat-7b\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("-- internlm_chat_7b_qlora_oasst1_e3_copy.py\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("-- openassistant-guanaco\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("   "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("-- openassistant_best_replies_eval.jsonl\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("   "),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("`")]),t._v("-- openassistant_best_replies_train.jsonl\n"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("`")])]),t._v("-- work_dirs\n    "),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("`")]),t._v("-- internlm_chat_7b_qlora_oasst1_e3_copy\n        "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("-- 20231101_152923\n        "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("   "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("-- 20231101_152923.log\n        "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("   "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("`")])]),t._v("-- vis_data\n        "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("       "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("-- 20231101_152923.json\n        "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("       "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("-- config.py\n        "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("       "),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("`")]),t._v("-- scalars.json\n        "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("-- epoch_1.pth\n        "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("-- epoch_2.pth\n        "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("-- epoch_3.pth\n        "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("-- internlm_chat_7b_qlora_oasst1_e3_copy.py\n        "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("`")])]),t._v("-- last_checkpoint\n")])])]),s("p",[t._v("将得到的 PTH 模型转换为 HuggingFace 模型，"),s("strong",[t._v("即：生成 Adapter 文件夹")])]),t._v(" "),s("p",[s("code",[t._v("xtuner convert pth_to_hf ${CONFIG_NAME_OR_PATH} ${PTH_file_dir} ${SAVE_PATH}")])]),t._v(" "),s("p",[t._v("在本示例中，为：")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("mkdir")]),t._v(" hf\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("export")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("MKL_SERVICE_FORCE_INTEL")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("export")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("MKL_THREADING_LAYER")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("GNU\nxtuner convert pth_to_hf ./internlm_chat_7b_qlora_oasst1_e3_copy.py ./work_dirs/internlm_chat_7b_qlora_oasst1_e3_copy/epoch_1.pth ./hf\n")])])]),s("p",[t._v("此时，路径中应该长这样：")]),t._v(" "),s("div",{staticClass:"language-Bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("-- internlm-chat-7b\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("-- internlm_chat_7b_qlora_oasst1_e3_copy.py\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("-- openassistant-guanaco\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("   "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("-- openassistant_best_replies_eval.jsonl\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("   "),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("`")]),t._v("-- openassistant_best_replies_train.jsonl\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("-- hf\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("   "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("-- README.md\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("   "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("-- adapter_config.json\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("   "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("-- adapter_model.bin\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("   "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("`")])]),t._v("-- xtuner_config.py\n"),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("`")]),t._v("-- work_dirs\n    "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("`")])]),t._v("-- internlm_chat_7b_qlora_oasst1_e3_copy\n        "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("-- 20231101_152923\n        "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("   "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("-- 20231101_152923.log\n        "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("   "),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("`")]),t._v("-- vis_data\n        "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("       "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("-- 20231101_152923.json\n        "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("       "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("-- config.py\n        "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("       "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("`")])]),t._v("-- scalars.json\n        "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("-- epoch_1.pth\n        "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("-- epoch_2.pth\n        "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("-- epoch_3.pth\n        "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("-- internlm_chat_7b_qlora_oasst1_e3_copy.py\n        `-- last_checkpoint\n")])])]),s("p",[s("span",{staticStyle:{color:"red"}},[s("strong",[t._v("此时，hf 文件夹即为我们平时所理解的所谓 “LoRA 模型文件”")])])]),t._v(" "),s("blockquote",[s("p",[t._v("可以简单理解：LoRA 模型文件 = Adapter")])]),t._v(" "),s("p",[s("strong",[t._v("部署与测试：")])]),t._v(" "),s("p",[t._v("将 HuggingFace adapter 合并到大语言模型：")]),t._v(" "),s("div",{staticClass:"language-Bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("xtuner convert merge ./internlm-chat-7b ./hf ./merged --max-shard-size 2GB\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# xtuner convert merge \\")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#     ${NAME_OR_PATH_TO_LLM} \\")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#     ${NAME_OR_PATH_TO_ADAPTER} \\")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#     ${SAVE_PATH} \\")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#     --max-shard-size 2GB")]),t._v("\n")])])]),s("p",[t._v("与合并后的模型对话：")]),t._v(" "),s("div",{staticClass:"language-Bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 加载 Adapter 模型对话（Float 16）")]),t._v("\nxtuner chat ./merged --prompt-template internlm_chat\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 4 bit 量化加载")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# xtuner chat ./merged --bits 4 --prompt-template internlm_chat")]),t._v("\n")])])]),s("p",[t._v("Demo")]),t._v(" "),s("ul",[s("li",[t._v("修改 "),s("code",[t._v("cli_demo.py")]),t._v(" 中的模型路径")])]),t._v(" "),s("div",{staticClass:"language-diff extra-class"},[s("pre",{pre:!0,attrs:{class:"language-diff"}},[s("code",[s("span",{pre:!0,attrs:{class:"token deleted-sign deleted"}},[s("span",{pre:!0,attrs:{class:"token prefix deleted"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token line"}},[t._v(' model_name_or_path = "/root/model/Shanghai_AI_Laboratory/internlm-chat-7b"\n')])]),s("span",{pre:!0,attrs:{class:"token inserted-sign inserted"}},[s("span",{pre:!0,attrs:{class:"token prefix inserted"}},[t._v("+")]),s("span",{pre:!0,attrs:{class:"token line"}},[t._v(' model_name_or_path = "merged"\n')])])])])]),s("ul",[s("li",[t._v("运行 "),s("code",[t._v("cli_demo.py")]),t._v(" 以目测微调效果")])]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("python ./cli_demo.py\n")])])]),s("p",[s("strong",[t._v("效果：")])]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("微调前")]),t._v(" "),s("th",[t._v("微调后")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("TODO")]),t._v(" "),s("td",[t._v("TODO")])])])]),t._v(" "),s("p",[s("strong",[s("code",[t._v("xtuner chat")])]),t._v(" "),s("strong",[t._v("的启动参数")])]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("启动参数")]),t._v(" "),s("th",[t._v("干哈滴")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[s("strong",[t._v("--prompt-template")])]),t._v(" "),s("td",[t._v("指定对话模板")])]),t._v(" "),s("tr",[s("td",[t._v("--system")]),t._v(" "),s("td",[t._v("指定SYSTEM文本")])]),t._v(" "),s("tr",[s("td",[t._v("--system-template")]),t._v(" "),s("td",[t._v("指定SYSTEM模板")])]),t._v(" "),s("tr",[s("td",[t._v("-"),s("strong",[t._v("-bits")])]),t._v(" "),s("td",[t._v("LLM位数")])]),t._v(" "),s("tr",[s("td",[t._v("--bot-name")]),t._v(" "),s("td",[t._v("bot名称")])]),t._v(" "),s("tr",[s("td",[t._v("--with-plugins")]),t._v(" "),s("td",[t._v("指定要使用的插件")])]),t._v(" "),s("tr",[s("td",[s("strong",[t._v("--no-streamer")])]),t._v(" "),s("td",[t._v("是否启用流式传输")])]),t._v(" "),s("tr",[s("td",[s("strong",[t._v("--lagent")])]),t._v(" "),s("td",[t._v("是否使用lagent")])]),t._v(" "),s("tr",[s("td",[t._v("--command-stop-word")]),t._v(" "),s("td",[t._v("命令停止词")])]),t._v(" "),s("tr",[s("td",[t._v("--answer-stop-word")]),t._v(" "),s("td",[t._v("回答停止词")])]),t._v(" "),s("tr",[s("td",[t._v("--offload-folder")]),t._v(" "),s("td",[t._v("存放模型权重的文件夹（或者已经卸载模型权重的文件夹）")])]),t._v(" "),s("tr",[s("td",[t._v("--max-new-tokens")]),t._v(" "),s("td",[t._v("生成文本中允许的最大 "),s("code",[t._v("token")]),t._v(" 数量")])]),t._v(" "),s("tr",[s("td",[s("strong",[t._v("--temperature")])]),t._v(" "),s("td",[t._v("温度值")])]),t._v(" "),s("tr",[s("td",[t._v("--top-k")]),t._v(" "),s("td",[t._v("保留用于顶k筛选的最高概率词汇标记数")])]),t._v(" "),s("tr",[s("td",[t._v("--top-p")]),t._v(" "),s("td",[t._v("如果设置为小于1的浮点数，仅保留概率相加高于 "),s("code",[t._v("top_p")]),t._v(" 的最小一组最有可能的标记")])]),t._v(" "),s("tr",[s("td",[t._v("--seed")]),t._v(" "),s("td",[t._v("用于可重现文本生成的随机种子")])])])])])}),[],!1,null,null,null);s.default=e.exports}}]);